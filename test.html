<!DOCTYPE html>
<html>
<head>
<title>Mandelbrot JS</title>
<script src="rainbowvis.js"></script>
<style type="text/css">
#trigger, #xp, #yp, #xz, #xm, #ym, #yz, #zfb{
height: 50px;
width: 60px;
}
#xa, #ya, #za, #zf{
height: 50px;
width: 70px;
}
</style>
</head>
<body>

<canvas id="paper" width="200" height="200">
</canvas>

<script type="text/javascript">
/* Init canvas, width, height, and context*/
var canvas = document.getElementById("paper");
var c = canvas.getContext("2d");
var a = canvas.width;
var b = canvas.height;

var pan = 0.01;
var zooms = 50;
var panX = -1.0;
var panY = -2.0;
var zf = 50;
var maxI = 100;

var pallete = new Rainbow();
pallete.setSpectrum("#000764","#206bcb","#edffff","#ffaa00","#000200");

//alert("#" + pallete.colourAt(255))
/* create mandelbrot */
function mandelbrot(zm, panX, panY){
/*
  px - Canvas x
  py - canvas y
  x - real x
  y - imaginary y
 */
var px, py, x, y; 
/*
  loop from y's, then loop all x's
 */
for(py = 0; py < a; py++){
	for(px = 0; px < b; px++){
	
	//zoom factors
	x = panX + px/zm;
	y = panY + py/zm;
	
	//x=-.50 + px/1200;
	//y=-.74 + py/1200;
	
	var xOld = x;
	var yOld = y;
	
	var r = 0;
	var i;
	//
	for(i = 0; i < maxI; i++){
	
	var xNew = (xOld * xOld) - (yOld * yOld) - x;
	var yNew = (2 * xOld * yOld) - y;
	

	var r = Math.sqrt((xNew * xNew) + (yNew * yNew));
	if((xNew * xNew + yNew * yNew ) > 4){
	break;
	}
	
	xOld = xNew;
	yOld = yNew;
	
	}
	//color
	var shade = pallete.colourAt(i);
	c.fillStyle = "#"+shade;
	c.fillRect(px,py,1,1);
	}
}

}

function work(){
document.getElementById("xa").value = -1;
document.getElementById("ya").value = -2;
document.getElementById("za").value = 50;

pan = 0.01;
zooms = 50;
panX = -1.0;
panY = -2.0;
zf = 50;
maxI = 100;
pallete.setNumberRange(0,100);

show();
mandelbrot(50, -1.0, -2.0);
}

function xScroll(n){
var temp = n ? parseFloat(document.getElementById("xa").value) + pan : parseFloat(document.getElementById("xa").value) - pan;
document.getElementById("xa").value = temp;
panX = temp;
show();
mandelbrot(zooms, temp, panY);
}

function yScroll(n){
var temp = n ? parseFloat(document.getElementById("ya").value) + pan : parseFloat(document.getElementById("ya").value) - pan;
document.getElementById("ya").value = temp;
panY = temp;
show();
mandelbrot(zooms, panX, temp);
}

function zoomIn(){
zooms = zooms + zf;
pan = (panX + 2 / zooms) - (panX - 1 / zooms);
document.getElementById("za").value = zooms;

if(0 < zooms && zooms < 100){
pallete.setNumberRange(0,255);
maxI = 255;
}else if(100 < zooms && zooms < 1000){
pallete.setNumberRange(0,500);
maxI = 500;
}else if(1000 < zooms && zooms < 10000){
pallete.setNumberRange(0,1000);
maxI = 1000;
}

show();
mandelbrot(zooms, panX, panY);
}

function zoomOut(){
zooms = zooms - zf;
pan = (panX + 2 / zooms) - (panX - 1 / zooms)
document.getElementById("za").value = zooms;

if(zooms < 100){
pallete.setNumberRange(0,100);
maxI = 100;
}else if(zooms > 100 && zooms < 1000){
pallete.setNumberRange(0,255);
maxI = 255;
}else if(zooms > 1000 && zooms < 10000){
pallete.setNumberRange(0,500);
maxI = 500;
}
show();
mandelbrot(zooms, panX, panY);
}

function zoomFactor(){
var temp = document.getElementById("zf").value;
zf = parseInt(temp);
show();
}

function show(){
var temp = "Scroll: " + pan + "<br /> Current zoom: " + zooms + "<br /> topLeftX: " +  panX + "<br /> topRightY: " + panY + "<br /> zoom factor: " +  zf + "<br /> max iterations of loop: " + maxI;
document.getElementById("dtls").innerHTML = temp;
}

/*favorable zoom
-0.373346235978374
-0.6582261932152258
7000

-0.3618206208864465
-0.6453957620586814
155300315925100
*/
</script>

<p>Mandelbrot Set Generator</p>
x-axis: <input type="text" id="xa" value="-1"/><input type="button" id="xp" value="+" onclick="xScroll(1)"/><input type="button" id="xm" value="-" onclick="xScroll(0)"/><br/>
<br/>
y-axis: <input type="text" id="ya" value="-2"/><input type="button" id="yp" value="+" onclick="yScroll(1)"/><input type="button" id="ym" value="-" onclick="yScroll(0)"/><br/>
<br/>
zoom: <input type="text" id="za" value="50"/><input type="button" id="xz" value="+" onclick="zoomIn()"/><input type="button" id="yz" value="-" onclick="zoomOut()"/><br/>
<br/>
zoom-factor: <input type="text" id="zf" value="100"/><input type="button" id="zfb" value="Change" onclick="zoomFactor()"/><br/>
<br/>
<input type="button" id="trigger" value="RESET" onclick="work()"/><input type="button" id="trigger" value=" V " onclick="show()"/>
<br />
<br />
<p> Advance Details </p>
<div id="dtls">
Click " V " to show details...
</div>
<br />
<p style="font-size: 10px">pvzzombs 2019</p>
</body>
</html>